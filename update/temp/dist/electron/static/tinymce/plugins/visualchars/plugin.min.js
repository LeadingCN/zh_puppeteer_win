!function(){"use strict";var n,t,o,e,r=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(n){return function(){return n}},u=i(!1),c=i(!0),a=function(){return s},s=(n=function(n){return n.isNone()},{fold:function(n,t){return n()},is:u,isSome:u,isNone:c,getOr:o=function(n){return n},getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:o,orThunk:t,map:a,each:function(){},bind:a,exists:u,forall:c,filter:a,equals:n,equals_:n,toArray:function(){return[]},toString:i("none()")}),f=function(n){return function(t){return typeof t===n}},l=("string",function(n){return o=typeof(t=n),"string"===(null===t?"null":"object"==o&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":o);var t,o}),d=f("boolean"),m=f("number"),v=function(n,t){for(var o=0,e=n.length;o<e;o++)t(n[o],o)},g=Object.keys,h=function(n,t){for(var o=g(n),e=0,r=o.length;e<r;e++){var i=o[e];t(n[i],i)}},p=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeValue}),y=(3,function(n){return 3===n.dom.nodeType}),b=function(n,t,o){!function(n,t,o){if(!(l(o)||d(o)||m(o)))throw new Error("Attribute value was not simple");n.setAttribute(t,o+"")}(n.dom,t,o)},w=function(n,t){n.dom.removeAttribute(t)},k=function(n,t){var o,e,r=(o=t,null===(e=n.dom.getAttribute(o))?void 0:e);return void 0===r||""===r?[]:r.split(" ")},A=function(n){return void 0!==n.dom.classList},C=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},N=C,O={" ":"nbsp","­":"shy"},T=function(n,t){var o="";return h(n,(function(n,t){o+=t})),new RegExp("["+o+"]",t?"g":"")},S=T(O),B=T(O,!0),V=(e="",h(O,(function(n){e&&(e+=","),e+="span.mce-"+n})),e),L="mce-nbsp",j=function(n){return'<span data-mce-bogus="1" class="mce-'+O[n]+'">'+n+"</span>"},x=function(n){var t=p(n);return y(n)&&void 0!==t&&S.test(t)},E=function(n,t){var o=[],e=function(n,t){for(var o=n.length,e=new Array(o),r=0;r<o;r++){var i=n[r];e[r]=t(i,r)}return e}(n.dom.childNodes,N);return v(e,(function(n){t(n)&&(o=o.concat([n])),o=o.concat(E(n,t))})),o},P=function(n){return"span"===n.nodeName.toLowerCase()&&n.classList.contains("mce-nbsp-wrap")},_=function(n,t){var o=E(N(t),x);v(o,(function(t){var o,e,r=t.dom.parentNode;if(P(r))o=N(r),e=L,A(o)?o.dom.classList.add(e):function(n,t){return e=t,r=k(o=n,"class").concat([e]),b(o,"class",r.join(" ")),!0;var o,e,r}(o,e);else{for(var i=n.dom.encode(p(t)).replace(B,j),u=n.dom.create("div",null,i),c=void 0;c=u.lastChild;)n.dom.insertAfter(c,t.dom);n.dom.remove(t.dom)}}))},D=function(n,t){var o=n.dom.select(V,t);v(o,(function(t){var o,e;P(t)?(o=N(t),e=L,A(o)?o.dom.classList.remove(e):function(n,t){return r=t,0<(i=function(n,t){for(var o=[],e=0,r=n.length;e<r;e++){var i=n[e];t(i)&&o.push(i)}return o}(k(o=n,e="class"),(function(n){return n!==r}))).length?b(o,e,i.join(" ")):w(o,e),!1;var o,e,r,i}(o,e),function(n){0===(A(n)?n.dom.classList:k(n,"class")).length&&w(n,"class")}(o)):n.dom.remove(t,!0)}))},q=function(n){var t=n.getBody(),o=n.selection.getBookmark(),e=void 0!==(e=function(n,t){for(;n.parentNode;){if(n.parentNode===t)return n;n=n.parentNode}}(n.selection.getNode(),t))?e:t;D(n,e),_(n,e),n.selection.moveToBookmark(o)},M=function(n,t){var o,e;o=n,e=t.get(),o.fire("VisualChars",{state:e});var r=n.getBody();(!0===t.get()?_:D)(n,r)},F=tinymce.util.Tools.resolve("tinymce.util.Delay"),I=function(n,t){return function(o){o.setActive(t.get());var e=function(n){return o.setActive(n.state)};return n.on("VisualChars",e),function(){return n.off("VisualChars",e)}}};r.add("visualchars",(function(n){var t,o,e,r,i,u,c,a,s,f,l=(t=n.getParam("visualchars_default_state",!1),o=t,{get:function(){return o},set:function(n){o=n}});return function(n,t){n.addCommand("mceVisualChars",(function(){!function(n,t){t.set(!t.get());var o=n.selection.getBookmark();M(n,t),n.selection.moveToBookmark(o)}(n,t)}))}(n,l),r=l,(e=n).ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:function(){return e.execCommand("mceVisualChars")},onSetup:I(e,r)}),e.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:function(){return e.execCommand("mceVisualChars")},onSetup:I(e,r)}),i=n,u=l,c=F.debounce((function(){q(i)}),300),!1!==i.getParam("forced_root_block")&&i.on("keydown",(function(n){!0===u.get()&&(13===n.keyCode?q(i):c())})),i.on("remove",c.stop),s=l,(a=n).on("init",(function(){M(a,s)})),f=l,{isEnabled:function(){return f.get()}}}))}();